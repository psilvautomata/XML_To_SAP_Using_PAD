# XML_to_SAP_Using_PAD

This project allows you to upload some files to SAP ERP by using Power Automate Desktop, using a main flow that interacts with an Outlook instance and performs actions based on the selection of different "usinas" (steel plants). This automation can be useful for managing tasks or processes specific to each steel plant, improving efficiency, and ensuring consistency in operations.

Below is an explanation of each section of the script.

## The main flow
Allows the user to choose between several options of Steel Plants presenting a selection dialog to the user, and calls specific sub-flows accordingly.

## Sub-Flows

For each Steel Plants, we have subflows that works on it, by using several lines of automation and specific keywords.

### _Region: Download to Folder_
This section of the script deals with obtaining emails and saving attachments to a specific folder by executing a series of keyboard commands and command prompt to execute some operations.

Then it Reads the content of a .txt file generated by the dir command and copies it to the clipboard.


### _Region: Excel Import_
This section deals with opening an Excel file and executing a macro to process the data within Excel.


### _Region: Date Control_
Here, the script prompts the user to enter a date range to process the files displaying a dialog box for the user to select a date range and then it finds the corresponding rows to the date range in Excel.


### _Region: IFERROR - Date Control_
If no match is found for the selected dates, the script asks the user to enter the dates again:

Prompts for a new start date until a match is found.
Prompts for a new end date until a match is found.


### _Region: Processing XML Files_
The script iterates over the rows of the found date range, processes the XML files, and moves them to a temporary folder.


### _Region: Start SAP_
Interaction with the SAP system to load the processed files:

Logs into SAP, starts some specifcs transactions. Then uses keyboard commands to fill in the necessary fields and execute the transaction in SAP.


### _Region: Cleanup and Completion_
Empties the original folder where the XML files were initially saved and closes the Excel and SAP instances opened earlier.
